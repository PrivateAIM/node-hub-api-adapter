"""String constants for tests."""

DS_TYPE = "fhir"

TEST_MOCK_ANALYSIS_ID = "1c9cb547-4afc-4398-bcb6-954bc61a1bb1"
TEST_MOCK_PROJECT_ID = "9cbefefe-2420-4b8e-8ac1-f48148a9fd40"
TEST_MOCK_NODE_ID = "9c521144-364d-4cdc-8ec4-cb62a537f10c"

ANALYSIS_NODES_RESP = [
    {
        "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "created_at": 1756790836,
        "updated_at": 1756790836,
        "analysis_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "node_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "comment": None,
        "artifact_tag": None,
        "artifact_digest": None,
        "analysis_id": "1452cf2d-e9d5-4a2d-822a-fc0a3b8cd2fd",
        "node_id": TEST_MOCK_NODE_ID,
        "approval_status": "approved",
        "run_status": "finished",  # Shouldn't start because finished
        "analysis": {
            "name": "headless-test",
            "project_id": TEST_MOCK_PROJECT_ID,
            "build_status": "finished",
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "configuration_locked": True,
            "nodes": 2,
            "realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "user_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "description": None,
            "master_image_id": None,
            "registry_id": None,
            "run_status": None,
            "name": None,
        },
    },
    {  # Ready to start
        "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "created_at": 1756790836,
        "updated_at": 1756790836,
        "analysis_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "node_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "comment": None,
        "artifact_tag": None,
        "artifact_digest": None,
        "analysis_id": TEST_MOCK_ANALYSIS_ID,
        "node_id": TEST_MOCK_NODE_ID,
        "approval_status": "approved",
        "run_status": None,
        "analysis": {
            "project_id": TEST_MOCK_PROJECT_ID,
            "build_status": "finished",
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "configuration_locked": True,
            "nodes": 2,
            "realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "user_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "description": None,
            "master_image_id": None,
            "registry_id": None,
            "run_status": None,
            "name": None,
        },
    },
    {
        "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "created_at": 1756790836,
        "updated_at": 1756790836,
        "analysis_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "node_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "comment": None,
        "artifact_tag": None,
        "artifact_digest": None,
        "analysis_id": "e4b9d64a-6619-4b31-9897-a85f37c83087",
        "node_id": TEST_MOCK_NODE_ID,
        "approval_status": "approved",
        "run_status": None,
        "analysis": {
            "project_id": TEST_MOCK_PROJECT_ID,
            "build_status": "starting",  # Shouldn't start because build isn't finished
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "configuration_locked": True,
            "nodes": 2,
            "realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "user_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "description": None,
            "master_image_id": None,
            "registry_id": None,
            "run_status": None,
            "name": None,
        },
    },
    {
        "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "created_at": 1756790836,
        "updated_at": 1756790836,
        "analysis_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "node_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "comment": None,
        "artifact_tag": None,
        "artifact_digest": None,
        "analysis_id": "a727fecb-bb28-4d9a-9a6e-6410a99de34a",
        "node_id": TEST_MOCK_NODE_ID,
        "approval_status": "rejected",  # Shouldn't start because rejected
        "run_status": None,
        "analysis": {
            "project_id": TEST_MOCK_PROJECT_ID,
            "build_status": "finished",
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "configuration_locked": True,
            "nodes": 2,
            "realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "user_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "description": None,
            "master_image_id": None,
            "registry_id": None,
            "run_status": None,
            "name": None,
        },
    },
    {
        "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "created_at": 1756790836,
        "updated_at": 1756790836,
        "analysis_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "node_realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
        "comment": None,
        "artifact_tag": None,
        "artifact_digest": None,
        "analysis_id": TEST_MOCK_ANALYSIS_ID,
        "node_id": TEST_MOCK_NODE_ID,
        "approval_status": "approved",
        "run_status": None,
        "analysis": {
            "project_id": "16cdb4d5-a4ee-47c4-822f-c0bfd4271ce2",  # Shouldn't start because project ID isn't in kong
            "build_status": "finished",
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "configuration_locked": True,
            "nodes": 2,
            "realm_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "user_id": "ac776c7f-c39d-4484-9a37-fa7109017192",
            "description": None,
            "master_image_id": None,
            "registry_id": None,
            "run_status": None,
            "name": None,
        },
    },
]

KONG_GET_ROUTE_RESPONSE = {
    "data": [
        {
            "created_at": 1756790836,
            "updated_at": 1756790836,
            "response_buffering": True,
            "headers": None,
            "paths": [f"/{TEST_MOCK_PROJECT_ID}-fhir/fhir"],
            "hosts": None,
            "path_handling": "v0",
            "https_redirect_status_code": 426,
            "service": {"id": "5156f9e8-229d-4752-90a5-e1991b9263ee"},
            "id": "e4a421d3-7e74-4af7-85a2-a3b509c455f8",
            "sources": None,
            "strip_path": True,
            "preserve_host": False,
            "snis": None,
            "destinations": None,
            "protocols": ["http"],
            "tags": [TEST_MOCK_PROJECT_ID, "fhir"],
            "name": f"{TEST_MOCK_PROJECT_ID}-fhir",
            "methods": ["GET"],
            "request_buffering": True,
            "regex_priority": 0,
        }
    ],
    "next": None,
}

KONG_ANALYSIS_SUCCESS_RESP = {
    "consumer": {
        "created_at": 1756891221,
        "custom_id": f"{TEST_MOCK_ANALYSIS_ID}-flame",
        "id": "6544a9a6-19af-4bfe-a6c2-a88c7d0dc12c",
        "tags": [TEST_MOCK_PROJECT_ID, TEST_MOCK_ANALYSIS_ID],
        "username": f"{TEST_MOCK_ANALYSIS_ID}-flame",
    },
    "keyauth": {
        "consumer": {"id": "6544a9a6-19af-4bfe-a6c2-a88c7d0dc12c"},
        "created_at": 1756891221,
        "id": "9c3f6705-f06d-4164-b828-62714f2ddce7",
        "key": "bdgTKiDd2J1XNzgrK8K6QQYtVjNx9Nyo",
        "tags": [TEST_MOCK_PROJECT_ID],
    },
    "acl": {
        "consumer": {"id": "6544a9a6-19af-4bfe-a6c2-a88c7d0dc12c"},
        "created_at": 1756891221,
        "id": "3075a2ca-8760-4db7-a81b-6a963a03e0aa",
        "group": TEST_MOCK_PROJECT_ID,
        "tags": [TEST_MOCK_PROJECT_ID],
    },
}
